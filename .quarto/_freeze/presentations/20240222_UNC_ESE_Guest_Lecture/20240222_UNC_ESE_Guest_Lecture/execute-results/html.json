{
  "hash": "c5f94b0ab9176ce2ad402abcd61430d9",
  "result": {
    "engine": "knitr",
    "markdown": "---\ntitle: \"Geospatial exposure modeling methods and applications in human health\"\nauthor: \n  - \"Kyle P Messier, PhD\"\ninstitute: \n  - \"**Stadtman Tenure Track Investigator**\"\n  - \"National Institute of Environmental Health Sciences\"\n  - \"Division of Translational Toxicology\" \n  - \"ENVR 500 Guest Lecture: February 22, 2024\"\nformat:  blackboard-revealjs\nself-contained: false\n---\n\n\n\n\n## About Me\n\n-   BS Environmental Science: UNC-Asheville\n-   MS, PhD, Environmental Science and Engineering, UNC ESE, Advisor: Marc Serre\n-   Postdoc, Environmental Defense Fund, High-Resolution Air Pollution Mapping with Mobile Monitoring\n-   Research Faculty, Oregon State University, Department of Environmental and Molecular Toxicology\n-   Tenure Track Investigator, NIH/NIEHS/DTT\n\n## About Us: {SET}~group~\n\n::: incremental\n-   Spatiotemporal Exposure Mapping\n-   Chemical and Stressor Mixtures Prediction\n-   Mechanistically Informed Risk Assessment\n:::\n\n::: hidden\n$$\n\\newcommand\\by{{\\mathbf{y}}}\n\\newcommand\\bY{{\\mathbf{Y}}}\n$$\n:::\n\n## About Us: {SET}~group~\n\n::: columns\n::: {.column width=\"60%\"}\n![](SETgroup-Oct2023.jpg){.framed style=\"width: 300px; height: auto;\"}\n:::\n\n::: {.column width=\"40%\"}\n-   Eva Marques\n\n-   Daniel Zilber\n\n-   Ranadeep Daw\n\n-   Mariana Alifa\n\n-   Insang Song\n\n-   Kyle Messier\n\n-   Mitchell Manware (Not Pictured)\n:::\n:::\n\n## The Importance of Place {auto-animate=\"true\" auto-animate-easing=\"ease-in-out\"}\n\n::: columns\n::: {.column width=\"70%\"}\n![](intro-map.png){.framed .absolute style=\"width: 600px; height: auto;\"}\n:::\n\n::: {.column width=\"30%\"}\n![](intro-map-caption.png){.framed .absolute style=\"width: 400px; height: auto;\"}\n:::\n:::\n\n## The Importance of Place\n\n::: columns\n::: {.column width=\"50%\"}\n![](Hurricane-Hog-Farms.jpg){.framed .absolute style=\"width: 400px; height: auto;\"}\n:::\n\n::: {.column width=\"50%\"}\n-   Hurricane Matthew, 2016\n-   Hurricane Florence, 2018\n-   Swine Waste Concerns\n-   Fecal Bateria\n-   Nitrate and Phosphorous Pollution\n-   Infectious Diseases\n:::\n:::\n\n## The Importance of Place\n\n::: panel-tabset\n## Flood\n\n![https://riskfactor.com/](https://assets.riskfactor.com/media/Perecent-Change.png){width=\"40%\"}\n\n## Wildfire\n\n![https://riskfactor.com/](https://assets.riskfactor.com/media/national-fire-dot-map@2x.png){width=\"40%\"}\n\n## Wind\n\n![https://riskfactor.com/](https://riskfactor.com/_next/image?url=https%3A%2F%2Fassets.riskfactor.com%2Fmedia%2Fwind.png&w=1080&q=75){width=\"40%\"}\n\n## Heat\n\n![https://riskfactor.com/](https://riskfactor.com/_next/image?url=https%3A%2F%2Fassets.riskfactor.com%2Fmedia%2FGroup-7683-2-2.png&w=3840&q=75){width=\"40%\"}\n\n## Air Quality\n\n![https://riskfactor.com/](https://assets.riskfactor.com/media/air.png){width=\"40%\"}\n:::\n\n## History of Spatial \\[Geo\\] Statistics ***Mining***\n\n::: columns\n::: {.column width=\"40%\"}\n![](mining.jpg)\n:::\n\n::: {.column width=\"60%\"}\n-   Matheron and Krige developed geostatistical methods to predict ore content from core samples\n\n-   Matheron coined the term \"Kriging\" after Krige\n\n-   \"Nugget\" is a term used to random noise because predicting where gold nuggets were was so difficult\n:::\n:::\n\n## History of Spatial \\[Geo\\] Statistics: ***Forestry***\n\n::: columns\n::: {.column width=\"40%\"}\n![](matern.png)\n:::\n\n::: {.column width=\"60%\"}\n-   Matérn developed correlation models for spatial variation for applications in Forestry\n\n-   To this day, we use the \"Matérn\" covariance function\n:::\n:::\n\n## History of Spatial \\[Geo\\] Statistics: ***Petroleum Engineering***\n\n::: columns\n::: {.column width=\"40%\"}\n![](petroleum.png)\n:::\n\n::: {.column width=\"60%\"}\n-   Used to evaluate the oil and gas field reservoirs\n-   Uses geology and seismic data\n:::\n:::\n\n## History of Spatial \\[Geo\\] Statistics: ***Public Health***\n\n::: columns\n::: {.column width=\"40%\"}\n![](book-cover.jpeg)\n:::\n\n::: {.column width=\"60%\"}\n-   Cressie, 1990: Statistics for Spatial Data\n\n-   Waller and Gotway, 2004: Applied Statistics for Public Health Data\n\n-   Wide scale adoption for statisticians and engineers in ecological and human exposure and risk applications\n:::\n:::\n\n## Source and Receptor Geometries {.scrollable}\n\n::: columns\n::: {.column width=\"60%\"}\n![](Source-receptor_data_type_combinations_20221017.jpg){width=\"80%\"}\n:::\n\n::: {.column width=\"40%\"}\nQuestions:\n\n::: incremental\n-   In figure C, what is an example of geospatial health data geometry at a point? Check all that apply.\n\n-   In figure I, what is an example of geospatial health data geometry at an area? Check all that apply.\n:::\n:::\n:::\n\n## Geospatial Health Analysis Overview {.scrollable}\n\n\n```{mermaid}\ngraph TD;\n\n    style A fill:#91bcfd , stroke:#333, stroke-width:2px, rounded:true;\n    style B fill:#91bcfd , stroke:#333, stroke-width:2px, rounded:true;\n    style C fill:#91bcfd , stroke:#333, stroke-width:2px, rounded:true;\n\n    A[Research Question: Exposure and Health Outcome Relationship?] --> B[Preparation of Geospatial Exposure Data];\n    A --> C[Preparation of Health Outcome Data];\n    \n  \n\n```\n\n\n## Geospatial Health Analysis Overview {.scrollable}\n\n\n```{mermaid}\ngraph TD;\n\n    style A fill:#91bcfd , stroke:#333, stroke-width:2px, rounded:true;\n    style B fill:#91bcfd , stroke:#333, stroke-width:2px, rounded:true;\n    style C fill:#91bcfd , stroke:#333, stroke-width:2px, rounded:true;\n\n    A[Research Question: Exposure and Health Outcome Relationship?] --> B[Preparation of Geospatial Exposure Data];\n    A --> C[Preparation of Health Outcome Data];\n    \n    B1[Selection of Exposure Metrics];\n    B2[Geospatial Exposure Modeling Strategy];\n    B3[Geospatial data collection and integration];\n    B4[Geospatial model fitting and calibration];\n    \n\n    B --> B1;\n    B1 --> B2;\n    B2 --> B3;\n    B3 --> B4;\n    \n\n```\n\n\nQuestions:\n\n::: incremental\n-   what is an example of a point-level exposure data set? Check all that apply.\n-   Which of the following are examples of an area-level exposure data set? Check all that apply.\n:::\n\n## Geospatial Health Analysis Overview {.scrollable}\n\n\n```{mermaid}\ngraph TD;\n\n    style A fill:#91bcfd , stroke:#333, stroke-width:2px, rounded:true;\n    style B fill:#91bcfd , stroke:#333, stroke-width:2px, rounded:true;\n    style C fill:#91bcfd , stroke:#333, stroke-width:2px, rounded:true;\n\n    A[Research Question: Exposure and Health Outcome Relationship?] --> B[Preparation of Geospatial Exposure Data];\n    A --> C[Preparation of Health Outcome Data];\n    \n    B1[Selection of Exposure Metrics];\n    B2[Geospatial Exposure Modeling Strategy];\n    B3[Geospatial data collection and integration];\n    B4[Geospatial model fitting and calibration];\n    \n    C1[Selection of health outcome metrics];\n    C2[Health outcome data collection and integration: Individual or Population Level];\n    C3[Geocoding of Health Outcome Data];\n\n    B --> B1;\n    B1 --> B2;\n    B2 --> B3;\n    B3 --> B4;\n    \n    C --> C1;\n    C1 --> C2;\n    C2 --> C3;\n    \n\n```\n\n\n## Geospatial Health Analysis Overview {.scrollable}\n\n\n```{mermaid}\ngraph TD;\n\n    style A fill:#91bcfd , stroke:#333, stroke-width:2px, rounded:true;\n    style B fill:#91bcfd , stroke:#333, stroke-width:2px, rounded:true;\n    style C fill:#91bcfd , stroke:#333, stroke-width:2px, rounded:true;\n    style D fill:#91bcfd , stroke:#333, stroke-width:2px, rounded:true;\n\n    A[Research Question: Exposure and Health Outcome Relationship?] --> B[Preparation of Geospatial Exposure Data];\n    A --> C[Preparation of Health Outcome Data];\n    \n    B1[Selection of Exposure Metrics];\n    B2[Geospatial Exposure Modeling Strategy];\n    B3[Geospatial data collection and integration];\n    B4[Geospatial model fitting and calibration];\n    \n    C1[Selection of health outcome metrics];\n    C2[Health outcome data collection and integration: Individual or Population Level];\n    C3[Geocoding of Health Outcome Data];\n    \n    D[Exposure and Health Outcome Data Integration and Analysis];\n    D1[Linkage of Exposure Model with Health Data];\n    D2[Prediction of Exposure Model at Health Data Locations];\n    D3[Exposure and Health Outcome Model Analysis];\n    \n    B --> B1;\n    B1 --> B2;\n    B2 --> B3;\n    B3 --> B4;\n    \n    C --> C1;\n    C1 --> C2;\n    C2 --> C3;\n    \n    B4 --> D;\n    C3 --> D;\n    \n    D --> D1;\n    D1 --> D2;\n    D2 --> D3;\n\n```\n\n\n## The Landscape of Geospatial Exposure Models {.scrollable}\n\n#### The next section will focus on details of geospatial exposure models\n\nMany types of models are used for geospatial exposure assessment.\n\n-   Proximity\n\n-   Index\n\n-   Land Use Regression\n\n-   Geographically Weighted Regression\n\n-   Kriging and Gaussian Processes\n\n-   Machine Learning\n\n-   Mechanistic Models\n\n-   Satellite Imagery\n\n-   Hybrid / Ensemble Models\n\n## Notation: Spatial Random Field\n\n-   $\\mathbf{y}$: A single random variable is denoted by a bold lowercase letter\n-   $\\mathbf{Y}$: Spatial Random Field (SRF): A collection of random variables across a spatial domain.\n-   SRF provides full, probabilistic characterization of exposure across space\n-   SRF is referenced to a real-valued domain with spatial and temporal indices, $\\{\\mathbf{Y}(s); s \\in \\mathbb{R}^2\\}$.\n\n## A Review of Linear Regression {.scrollable}\n\nResponse\n\n$$\n    Y_i \\in  \\{1, ..., n\\} \n$$ $p$ covariates:\n\n$$\n    X = X_{i1}, ..., X_{ip}\n$$\n\nThe model is :\n\n$$\n    Y_i = \\beta_0 + X_{i1}\\beta_1 + , ..., X_{ip}\\beta_p\n$$\n\n-   The mean is a linear combination of the covariates\n\n$$\nE(Y_i) = \\mu_i = \\beta_0 + X_{i1}\\beta_1 + ... + X_{ip}\\beta_p\n$$\n\n-   Error/Residuals are assumed to be independent and identically distributed (iid)\n\n$$\n\\varepsilon_i = Y_i - \\mu_i\n$$\n\n## Linear Regression for spatial idea\n\n-   As a method, not a terrible idea\n\n-   Unbiased\n\n-   Overconfident error estiamte (p-values, SE)\n\n-   Model Selection (Type 1 and 2 error)\n\n## Land Use Regression\n\nLinear regression for spatial data\n\n$$\n    \\bY(s) =  X(s)\\beta + \\varepsilon\n$$\n\n$$\n    X(s) = X_{i1}(s_1), ..., X_{ip}(s_p)\n$$\n\n## Spatial Covariance Model\n\n-   As a random-effect model, we add a spatially explicity error term\n\n$$\n    \\bY(s) = \\mu(s) + \\varepsilon +  \\eta(s)\n$$\n\n-   $\\mu(s)$ can take many forms such as linear, nonlinear, or even machine learning models such as random forest.\n\n-   More details on a spatial covariance model later\n\n## Proximity {.scrollable}\n\n-   Proximity based metrics are the most basic form of an exposure assessment because they rely only on the distance between a pollution source and the observed outcome location.\n\n-   A proximity model is simply a deterministic covariate based on distance:\n\n$$\n  Y(s) = X(s) \n$$\n\nGiven a matrix of distances between monitoring locations and pollution sources, $d_{ij}$, minimum and average distance are:\n\n$$\n  X_i^{min} = min(d_{i,\\cdot}) \\\\\n  \\overline{X}_i = \\frac{1}{n_j}\\sum_{j=1}^{n_j}d_{ij}\\\\\n$$\n\nQuestions:\n\n::: incremental\n-   What are examples of proximity metrics? Check all that apply.\n-   What are the advantages of a proximity metric? Check all that apply.\n:::\n\n## Index Models\n\n-   Index variables are deterministic quantities that summarize (e.g. prinicipal components) multiple complex variables of interest into a simple and interpretable metric.\n\n-   Covariates are made up of geographic variables across different domains\n\n-   Social Vulnerability Index, Climate Vulnerability Index, etc.\n\n## Land Use Regression {.scrollable}\n\n$$\n  \\bY(s) =  X(s)\\beta + \\varepsilon\n$$ - where $\\bY(p)$ are the $n \\times 1$ observations for the variable of interest (e.g. PM$_{2.5}$, $NO_3^{-}$, etc.). $X(s)$ is a $n \\times k$ design matrix of $k$ spatial geographic covariates\n\nKey Steps\n\n::: incremental\n1.  Calculate geographic covariates\n2.  Fit the model - may include model selection or dimension reduction\n3.  Predict at unmonitored locations\n:::\n\n## Geographically Weighted Regression\n\n::: incremental\n-   $$   \\bY(s) =  X(s)\\beta(s) + \\varepsilon\n     $$\n-   What is the key difference between LUR and GWR? Select one. Recall, LUR = $\\bY(s) = X(s)\\beta + \\varepsilon$\n-   Hint: It's in the $\\beta$\n-   ![](GWR.png)\n:::\n\n## Gaussian Process and Kriging\n\n::: incremental\n-   Gaussian process and Kriging are one in the same\n-   Utilize information on spatial correlation to help interpolate\n-   Account for spatial error\n-   Highly flexible\n:::\n\n## Gaussian Process and Kriging {.scrollable}\n\n$$\n    \\bY(s) = \\mu(s) +  \\eta(s)\n$$\n\n-   $\\mu(s)$ can take many forms such as linear, nonlinear, or even machine learning models such as random forest\n\n-   $\\eta \\sim N_n(0,\\Sigma_{\\theta}+\\tau^2I)$\n\n-   $\\Sigma_{\\theta}$ is a covariance matrix with parameters, $\\theta$, that accounts for correlation between spatial and temporal locations\n\nQuestion:\n\n::: incremental\n-   What physical quantity is $\\Sigma_{\\theta}$ solely dependent on?\n:::\n\n## Machine Learning {.scrollable}\n\nMachine learning (ML) is the general culture, philosophy, or school of thought for predictive modeling that focuses on the learning algorithm and out-of-sample prediction generalization\n\n::: incremental\n-   Many common machine learning algorithms can be used for geospatial modeling\n-   Flexible\n-   Don't make strict assumptions on the distriubtions of the data\n-   Coordinates and other spatial information is input as covariates\n:::\n\n::: incremental\n-   Common Methods in Exposure Modeling\n:::\n\n::: incremental\n-   Generalized Additive Models (GAM)\n-   Random Forest\n-   xgboost\n-   Neural Networks: CNN, LSTM, GAN, etc.\n:::\n\n## Machine Learning: Trees\n\n![](https://raw.githubusercontent.com/dmlc/web-data/master/xgboost/model/cart.png) ![](https://raw.githubusercontent.com/dmlc/web-data/master/xgboost/model/twocart.png)\n\n## Mechanistic {.scrollable}\n\n::: incremental\n-   I would be remiss if I didn't mention another entirely different class of exposure models\n\n-   Mechanistic models are not statistical models\n\n-   Mechanistic models are based on physics and chemistry\n\n-   ![](https://fluid.nccs.nasa.gov/reanalysis/static/plots/ff7cb080-991a-306c-b51b-25cb9b490035.png){width=\"50%\"}\n:::\n\n## Hybrid {.scrollable}\n\n### A consensus of multiple models is almost always better than any single model.\n\nRequia, Weeberb J., et al. \"An ensemble learning approach for estimating high spatiotemporal resolution of ground-level ozone in the contiguous United States.\" Environmental science & technology 54.18 (2020): 11037-11047.\n\n![](https://pubs.acs.org/cms/10.1021/acs.est.0c01791/asset/images/medium/es0c01791_0005.gif){width=\"50%\"} Yu, Wenhua, et al. \"Deep ensemble machine learning framework for the estimation of PM 2.5 concentrations.\" Environmental Health Perspectives 130.3 (2022): 037004.\n\n![](https://ehp.niehs.nih.gov/cms/10.1289/EHP9752/asset/5ddec431-0e9c-45a0-a4d4-756370dc6a70/assets/images/large/ehp9752_f1.jpg){width=\"50%\"}\n\n## Integrating Geospatial Exposure Models into Health Data {.scrollable}\n\n\n```{mermaid}\ngraph TD;\n\n    style A fill:#91bcfd , stroke:#333, stroke-width:2px, rounded:true;\n    style B fill:#91bcfd , stroke:#333, stroke-width:2px, rounded:true;\n    style C fill:#91bcfd , stroke:#333, stroke-width:2px, rounded:true;\n    style D fill:#91bcfd , stroke:#333, stroke-width:2px, rounded:true;\n\n    A[Research Question: Exposure and Health Outcome Relationship?] --> B[Preparation of Geospatial Exposure Data];\n    A --> C[Preparation of Health Outcome Data];\n    \n    B1[Selection of Exposure Metrics];\n    B2[Geospatial Exposure Modeling Strategy];\n    B3[Geospatial data collection and integration];\n    B4[Geospatial model fitting and calibration];\n    \n    C1[Selection of health outcome metrics];\n    C2[Health outcome data collection and integration: Individual or Population Level];\n    C3[Geocoding of Health Outcome Data];\n    \n    D[Exposure and Health Outcome Data Integration and Analysis];\n    D1[Linkage of Exposure Model with Health Data];\n    D2[Prediction of Exposure Model at Health Data Locations];\n    D3[Exposure and Health Outcome Model Analysis];\n    \n    B --> B1;\n    B1 --> B2;\n    B2 --> B3;\n    B3 --> B4;\n    \n    C --> C1;\n    C1 --> C2;\n    C2 --> C3;\n    \n    B4 --> D;\n    C3 --> D;\n    \n    D --> D1;\n    D1 --> D2;\n    D2 --> D3;\n\n```\n\n\n## Classical Framework for Geospatial Risk Assessment {.scrollable}\n\n\n```{mermaid}\ngraph TB;\n\n    style A fill:#91bcfd , stroke:#333, stroke-width:2px, rounded:true;\n\n    A(Hazard Identification);\n    B(External Exposure Assessment) --> |Behaviorial, Physiological, Toxicokinetic Modeling| C(Internal Exposure);\n    C --> |Epidemiological Methods| E(Health Effect Assessment);\n    E --> |Health Impact Model| F(Health Burden);\n    B --> |Epidemiological Methods| E;\n\n```\n\n\nQuestions\n\n::: incremental\n-   The left size of the figure shows an option to calculate internal exposure from a geospatially modeled external exposure. What are some key assumptions in this approach?\n:::\n\n## Classical Framework for Geospatial Risk Assessment {.scrollable}\n\n![](GBD-PM25.png){width=\"100%\"}\n",
    "supporting": [],
    "filters": [
      "rmarkdown/pagebreak.lua"
    ],
    "includes": {
      "include-after-body": [
        "\n<script>\n  // htmlwidgets need to know to resize themselves when slides are shown/hidden.\n  // Fire the \"slideenter\" event (handled by htmlwidgets.js) when the current\n  // slide changes (different for each slide format).\n  (function () {\n    // dispatch for htmlwidgets\n    function fireSlideEnter() {\n      const event = window.document.createEvent(\"Event\");\n      event.initEvent(\"slideenter\", true, true);\n      window.document.dispatchEvent(event);\n    }\n\n    function fireSlideChanged(previousSlide, currentSlide) {\n      fireSlideEnter();\n\n      // dispatch for shiny\n      if (window.jQuery) {\n        if (previousSlide) {\n          window.jQuery(previousSlide).trigger(\"hidden\");\n        }\n        if (currentSlide) {\n          window.jQuery(currentSlide).trigger(\"shown\");\n        }\n      }\n    }\n\n    // hookup for slidy\n    if (window.w3c_slidy) {\n      window.w3c_slidy.add_observer(function (slide_num) {\n        // slide_num starts at position 1\n        fireSlideChanged(null, w3c_slidy.slides[slide_num - 1]);\n      });\n    }\n\n  })();\n</script>\n\n"
      ]
    },
    "engineDependencies": {},
    "preserve": {},
    "postProcess": true
  }
}